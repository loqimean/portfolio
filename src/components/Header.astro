---
import { getTranslations, DEFAULT_LANGUAGE } from '../i18n/translations';
import { ThemeToggle } from '../react/ThemeToggle';

interface Props {
  currentLang: string;
  hasContactForm?: boolean;
  contactEmail?: string;
}

const { currentLang, hasContactForm = false, contactEmail = '' } = Astro.props;
const t = getTranslations(currentLang);


// Create proper i18n links
const getLocalizedPath = (locale: string) => {
  if (locale === DEFAULT_LANGUAGE) return '/';
  return `/${locale}`;
};

const toggleTheme = () => {
  const currentTheme = localStorage.getItem('theme') || document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
}
---

<header class="top-3 z-100 fixed w-full">
  <nav class="container mx-auto px-8 py-4 rounded-3xl overflow-hidden backdrop-blur-xl">
    <div class="flex justify-between items-center px-4">
      <!-- Simple I+M logo -->
      <svg class="dark:text-white" width="48" height="48" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0 0.909046H1.32834L3.99503 4.99996L6.67166 0.909046H8V9.09087H6.95887V2.8746H6.86911L4.49565 6.36359H3.49441L1.13089 2.8746H1.04113V9.09087H0V0.909046Z" fill="currentColor"/>
        <path d="M4.5056 2.09086V10.2727H3.50435V2.09086H4.5056Z" fill="currentColor"/>
        <path d="M3.50435 -8.87513e-05H4.5056V0.909002H3.50435V-8.87513e-05Z" fill="currentColor"/>
      </svg>

      <div class="flex items-center gap-4 uppercase">
        <a href="/" class="no-underline">Home</a>
        <a href="/" class="no-underline">Blog</a>
        <a href="/" class="no-underline">OpenSource</a>
      </div>

      <div class="flex gap-4 items-center">
        <!-- <ThemeToggle t={t} client:only="react" /> -->
        <a
          class="contact-link"
          href={hasContactForm ? '#contact-section' : `mailto:${contactEmail}`}
          title={t.contact}
        >
          <i class="icon-[jam--envelope] size-6"></i>
          <span>{t.contact}</span>
        </a>

        <div class="flex hidden gap-2 bg-(--card-bg) rounded-lg p-1">
          <a
            href={getLocalizedPath('en')}
            class={`px-4 py-2 rounded-md cursor-pointer text-sm font-medium transition-all duration-200 no-underline ${
              currentLang === 'en'
                ? 'bg-(--accent-color) text-white'
                : 'text-(--text-color) hover:bg-(--bg-color)'
            }`}
            aria-label="Switch to English"
          >
            EN
          </a>
          <a
            href={getLocalizedPath('uk')}
            class={`px-4 py-2 rounded-md cursor-pointer text-sm font-medium transition-all duration-200 no-underline ${
              currentLang === 'uk'
                ? 'bg-(--accent-color) text-white'
                : 'text-(--text-color) hover:bg-(--bg-color)'
            }`}
            aria-label="Перемкнути на Українську"
          >
            UK
          </a>
          <a
            href={getLocalizedPath('pl')}
            class={`px-4 py-2 rounded-md cursor-pointer text-sm font-medium transition-all duration-200 no-underline ${
              currentLang === 'pl'
                ? 'bg-(--accent-color) text-white'
                : 'text-(--text-color) hover:bg-(--bg-color)'
            }`}
            aria-label="Przełącz na Polski"
          >
            PL
          </a>
          <a
            href={getLocalizedPath('es')}
            class={`px-4 py-2 rounded-md cursor-pointer text-sm font-medium transition-all duration-200 no-underline ${
              currentLang === 'es'
                ? 'bg-(--accent-color) text-white'
                : 'text-(--text-color) hover:bg-(--bg-color)'
            }`}
            aria-label="Cambiar a Español"
          >
            ES
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
